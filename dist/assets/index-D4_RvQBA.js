(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();const S={MATCH_GOAL:12,MIN_PLAYERS:10,BATRACE_BASE:"https://batrace.aoeiaol.top/api/v1",BARMORY_BASE:"https://www.barmory.net",PROXIES:[{name:"Codetabs",url:e=>`https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(e)}`},{name:"CorsProxy",url:e=>`https://corsproxy.io/?${encodeURIComponent(e)}`},{name:"AllOrigins",url:e=>`https://api.allorigins.win/get?url=${encodeURIComponent(e)}&cb=${Date.now()}`}],WCS_WEIGHTS:{battlefield:.29,combat:.18,firepower:.11,economy:.11,teamwork:.1,strategy:.06,winBonus:.15},WCS_LEVELS:[{min:80,key:"legendary"},{min:65,key:"elite"},{min:50,key:"good"},{min:35,key:"average"},{min:20,key:"below"},{min:0,key:"poor"}],RANK_WEIGHTS:{impact:.4,obj:.1,loss:.15,tank:.35},LS_UNIT_CACHE_KEY:"ba_unit_cache",LS_UNIT_CACHE_TS:"ba_unit_cache_ts",LS_HISTORY_KEY:"ba_history"},we={title:"Êñ≠ÁÆ≠ÊàòÊúØÂàÜÊûê",subtitle:"Broken Arrow Tactical Analysis",placeholder:"Steam64 ID Êàñ Ê∏∏ÊàèÂÜÖÈÉ®Êï∞Â≠ó ID...",check:"ÂºÄÂßãÂàÜÊûê",loading:"Âä†ËΩΩ‰∏≠...",err_insufficient:"ÊúâÊïàÂØπÂ±Ä‰∏çË∂≥ 12 Â±ÄÔºåËØ∑ËøáÊÆµÊó∂Èó¥ÂÜçËØï„ÄÇ",find_id:"‰∏çÁü•ÈÅì IDÔºüÈÄöËøáÁî®Êà∑ÂêçÊü•Êâæ",find_match:"Âè™Áü•ÈÅìÂØπÂ±Ä IDÔºüÈÄöËøáÂØπÂ±ÄÊü•Áé©ÂÆ∂",history_title:"ÊúÄËøë 12 Â±ÄÊúâÊïàÂØπÂ±Ä",maggot_index_title:"ËÉúÂà©Ë¥°ÁåÆÂ∫¶",god_range:"0",maggot_range:"100",lbl_ref_impact:"ÊàòÂú∫Ë¥°ÁåÆ",lbl_ref_dr:"ÊàòÊñóÊïàÁéá",lbl_ref_tr:"ÁªèÊµéÁÆ°ÁêÜ",lbl_ref_or:"Âõ¢ÈòüÂçè‰Ωú",lbl_ref_wr:"ËÉúÁéá",trend_up:"üìà ‰∏äÂçáË∂ãÂäø",trend_down:"üìâ ‰∏ãÈôçË∂ãÂäø",trend_flat:"‚û°Ô∏è Á®≥ÂÆöÂèëÊå•",trend_desc:"ÊúÄËøë3Â±Ä vs ‰πãÂâç9Â±ÄË°®Áé∞Ë∂ãÂäø",elo_desc:"ÂΩìÂâç ELO ËØÑÂàÜ",modal_title:"Áé©ÂÆ∂ÂÜÖÈÉ® ID Êü•ËØ¢",modal_btn_search:"Êü•ËØ¢",modal_pname:"Áé©ÂÆ∂ÂêçÁß∞",modal_pid:"ÂÜÖÈÉ® ID",modal_use_id:"‰ΩøÁî®Ê≠§ ID Ê£ÄÊµã",modal_status_search:"Ê≠£Âú®ÊêúÁ¥¢...",modal_status_none:"Êú™ÊâæÂà∞Áé©ÂÆ∂",modal_status_found:"ÊâæÂà∞ {n} ‰∏™ÁªìÊûú",modal_status_err:"Êü•ËØ¢Âá∫Èîô: ",modal_match_title:"ÈÄöËøáÂØπÂ±Ä ID Êü•ÊâæÁé©ÂÆ∂",modal_match_input_ph:"ËæìÂÖ•ÂØπÂ±Ä ID (Â¶Ç 184523)...",modal_match_btn_search:"Ëé∑ÂèñÊàòÁª©",modal_match_loading:"Ê≠£Âú®Ëé∑ÂèñÂØπÂ±Ä‰ø°ÊÅØ...",modal_match_err:"Ëé∑ÂèñÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü• ID ÊòØÂê¶Ê≠£Á°Æ",kill:"ÂáªÊùÄ",loss:"ÊçüÂ§±",obj:"Âç†ÁÇπ",wcs_levels:{legendary:"üèÜ Ë∂ÖÂá°ÊàòÁ•û",elite:"üíé Á≤æËã±ÊåáÊå•ÂÆò",good:"‚öîÔ∏è È™ÅÂãáÊàòÂ£´",average:"üìä ‰∏≠ËßÑ‰∏≠Áü©",below:"‚ö†Ô∏è ÈúÄË¶ÅÊèêÂçá",poor:"üêõ Á∫ØËõÜË°å‰∏∫"},style_dims:{battlefield:"ÊàòÂú∫Ë¥°ÁåÆ",combat:"ÊàòÊñóÊïàÁéá",economy:"ÁªèÊµéÁÆ°ÁêÜ",teamwork:"Âõ¢ÈòüÂçè‰Ωú",strategy:"ÊàòÁï•ÁõÆÊ†á",firepower:"ÁÅ´ÂäõËæìÂá∫"},wcs_tips:{battlefield:`ÈòüÂÜÖÊçüÂ§±ÊâøÊãÖ + ÈòüÂÜÖ‰º§ÂÆ≥Âç†ÊØî + ÈòüÂÜÖÂáªÊØÅÂç†ÊØî
ÊùÉÈáç: 29% (SHAP ÊúÄÈ´ò)`,combat:`D/LÊØî + Â≠òÊ¥ªÁéá + ‰º§ÂÆ≥‰∫§Êç¢ÊØî + ÊàêÊú¨ÊïàÁéá
ÊùÉÈáç: 16%`,economy:`ÈÄÄÂÖµÁéá + ÈÄÄÊ¨æÊÄªÈ¢ù
ÊùÉÈáç: 16%`,teamwork:`ÂÖµÁßçÂ§öÊ†∑ÊÄß + Ë°•ÁªôÊî∂Âà∞/ÁªôÂá∫
ÊùÉÈáç: 10%`,strategy:`Âç†ÁÇπ + Êä¢Ë°•Áªô + ÊëßÊØÅÂª∫Á≠ë
ÊùÉÈáç: 8%`,firepower:`‰º§ÂÆ≥ËæìÂá∫ + ÂáªÊØÅÂæóÂàÜ
ÊùÉÈáç: 6%`},tag_killer:"‚öîÔ∏è ÂáªÊùÄ‰∏∫‰∏ª",tag_kd:"üìà KD ‰∏∫‰∏ª",tag_obj:"üö© Âç†ÁÇπ‰∏∫‰∏ª",res_vic:"ËÉúÂà©",res_def:"Â§±Ë¥•",res_draw:"Âπ≥Â±Ä",meta_map:"Âú∞Âõæ",meta_dur:"Êó∂Èïø",meta_win:"ËÉúÊñπ",reasons:{1:"ÂéãÂà∂",2:"ËÆ°ÂàÜ/Ë∂ÖÊó∂",3:"ÊäïÈôç"},medals:{Destruction:"ÂáªÊùÄÁéã",Losses:"ÈÄÅÊ≠ªÁéã",DamageDealt:"ÁÇ∏ÁÇ∏ÁÇ∏",DamageReceived:"Êå®ÊâìÁéã",SupplyPointsConsumed:"Â§ßËÉÉË¢ã",SupplyPointsConsumedFromAllies:"Â∞èÈ¶ãÁå´",SupplyPointsConsumedByAllies:"Â•∂Â¶à",TotalSpawnedUnitScore:"ÈááË¥≠ÂÆò",TotalRefundedUnitScore:"‰ªÖÈÄÄÊ¨æ"},medal_descs:{Destruction:"ÂáªÊùÄÂæóÂàÜÂÖ®ÈòüÊúÄÈ´ò",Losses:"ÊçüÂ§±ÂæóÂàÜÂÖ®ÈòüÊúÄÈ´ò (ÈÄÅÂàÜÊúÄÂ§ö)",DamageDealt:"ÂØπÊïåÈÄ†Êàê‰º§ÂÆ≥ÊÄªÈáèÂÖ®ÈòüÊúÄÈ´ò",DamageReceived:"ÊâøÂèóÊïåÊñπ‰º§ÂÆ≥ÊÄªÈáèÂÖ®ÈòüÊúÄÈ´ò",SupplyPointsConsumed:"Ë°•ÁªôÊ∂àËÄóÊÄªÈáèÂÖ®ÈòüÊúÄÈ´ò",SupplyPointsConsumedFromAllies:"‰ªéÁõüÂèãÂ§ÑËé∑ÂèñË°•ÁªôÂÖ®ÈòüÊúÄÂ§ö",SupplyPointsConsumedByAllies:"Ë¢´ÁõüÂèãÊ∂àËÄóË°•ÁªôÂÖ®ÈòüÊúÄÂ§öÔºàÂ•∂ÈáèÊúÄÂ§ßÔºâ",TotalSpawnedUnitScore:"ÈÉ®ÁΩ≤Âçï‰ΩçÊÄªÁÇπÊï∞ÂÖ®ÈòüÊúÄÈ´ò",TotalRefundedUnitScore:"ÈÄÄÊ¨æÂçï‰ΩçÊÄªÁÇπÊï∞ÂÖ®ÈòüÊúÄÈ´ò"},lbl_fav_units_title:"Áà±Áî®Âçï‰Ωç (ÊúÄËøë 12 Â±Ä)",lbl_fav_dmg:"ÊúÄÈ´ò‰º§ÂÆ≥",lbl_fav_kill:"ÊúÄÂ§öÂáªÊùÄ",lbl_fav_tank:"ÊúÄÂ§öÊâø‰º§",unit_dmg_title:"ÊúÄÈ´ò‰º§ÂÆ≥",unit_kill_title:"ÊúÄÈ´òÂáªÊùÄ",unit_tank_title:"ÊúÄÈ´òÊâø‰º§",pd_dmg_dealt:"‰º§ÂÆ≥ËæìÂá∫",pd_dmg_taken:"ÊâøÂèó‰º§ÂÆ≥",pd_supply:"Ë°•ÁªôÊ∂àËÄó",pd_supply_ally:"ÂêÉÁõüÂèãË°•Áªô",pd_supply_give:"ÂñÇÁõüÂèãË°•Áªô",pd_units:"Âçï‰ΩçÊÄªÂÄº"},ve={title:"BA Tactical Analysis",subtitle:"Broken Arrow Tactical Analysis",placeholder:"Steam64 ID or in-game numeric ID...",check:"Analyze",loading:"Loading...",err_insufficient:"Not enough valid matches (need 12). Try again later.",find_id:"Don't know your ID? Search by username",find_match:"Know a match ID? Find players from match",history_title:"Recent 12 Valid Matches",maggot_index_title:"Win Contribution Score",god_range:"0",maggot_range:"100",lbl_ref_impact:"Battlefield",lbl_ref_dr:"Combat",lbl_ref_tr:"Economy",lbl_ref_or:"Teamwork",lbl_ref_wr:"Win Rate",trend_up:"üìà Improving",trend_down:"üìâ Declining",trend_flat:"‚û°Ô∏è Stable",trend_desc:"Recent 3 vs previous 9 matches trend",elo_desc:"Current ELO rating",modal_title:"Find Player ID",modal_btn_search:"Search",modal_pname:"Player Name",modal_pid:"Internal ID",modal_use_id:"Use This ID",modal_status_search:"Searching...",modal_status_none:"No players found",modal_status_found:"Found {n} result(s)",modal_status_err:"Error: ",modal_match_title:"Find Players by Match ID",modal_match_input_ph:"Enter match ID (e.g. 184523)...",modal_match_btn_search:"Get Match",modal_match_loading:"Fetching match data...",modal_match_err:"Failed to fetch. Check ID.",kill:"Kill",loss:"Loss",obj:"Obj",wcs_levels:{legendary:"üèÜ Legendary",elite:"üíé Elite",good:"‚öîÔ∏è Skilled",average:"üìä Average",below:"‚ö†Ô∏è Below Avg",poor:"üêõ Poor"},style_dims:{battlefield:"Battlefield",combat:"Combat",economy:"Economy",teamwork:"Teamwork",strategy:"Strategy",firepower:"Firepower"},tag_killer:"‚öîÔ∏è Kill Focused",tag_kd:"üìà KD Focused",tag_obj:"üö© Obj Focused",res_vic:"Victory",res_def:"Defeat",res_draw:"Draw",meta_map:"Map",meta_dur:"Duration",meta_win:"Winner",reasons:{1:"Domination",2:"Score/Time",3:"Surrender"},medals:{Destruction:"Top Killer",Losses:"Most Losses",DamageDealt:"Top Damage",DamageReceived:"Tank",SupplyPointsConsumed:"Big Spender",SupplyPointsConsumedFromAllies:"Supply Leech",SupplyPointsConsumedByAllies:"Medic",TotalSpawnedUnitScore:"Shopper",TotalRefundedUnitScore:"Refunder"},medal_descs:{Destruction:"Highest destruction score in team",Losses:"Highest losses in team",DamageDealt:"Highest total damage dealt in team",DamageReceived:"Highest damage received in team",SupplyPointsConsumed:"Highest supply consumed in team",SupplyPointsConsumedFromAllies:"Most supply taken from allies",SupplyPointsConsumedByAllies:"Most supply given to allies",TotalSpawnedUnitScore:"Highest total unit score deployed",TotalRefundedUnitScore:"Highest refunded unit score"},lbl_fav_units_title:"Favorite Units (Last 12)",lbl_fav_dmg:"Top Damage",lbl_fav_kill:"Top Kills",lbl_fav_tank:"Top Tank",unit_dmg_title:"Top Damage",unit_kill_title:"Top Kills",unit_tank_title:"Top Tank",pd_dmg_dealt:"Dmg Dealt",pd_dmg_taken:"Dmg Taken",pd_supply:"Supply Used",pd_supply_ally:"From Allies",pd_supply_give:"To Allies",pd_units:"Unit Score"},xe={title:"BA –¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏–∑",subtitle:"Broken Arrow Analytics",placeholder:"Steam64 ID –∏–ª–∏ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π ID...",check:"–ê–ù–ê–õ–ò–ó",loading:"–ó–∞–≥—Ä—É–∑–∫–∞...",err_insufficient:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞—Ç—á–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",find_id:"–ù–µ –∑–Ω–∞–µ—Ç–µ ID? –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏",find_match:"–ó–Ω–∞–µ—Ç–µ ID –º–∞—Ç—á–∞? –ù–∞–π—Ç–∏ –∏–≥—Ä–æ–∫–æ–≤",history_title:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–∞—Ç—á–µ–π",maggot_index_title:"–í–∫–ª–∞–¥ –≤ –ø–æ–±–µ–¥—É",god_range:"0",maggot_range:"100",lbl_ref_impact:"–ë–æ–π",lbl_ref_dr:"–ë–æ–µ–≤–∞—è —ç—Ñ—Ñ.",lbl_ref_tr:"–≠–∫–æ–Ω–æ–º–∏–∫–∞",lbl_ref_or:"–ö–æ–º–∞–Ω–¥–∞",lbl_ref_wr:"–í–∏–Ω—Ä–µ–π—Ç",trend_up:"üöÄ –°–∏–ª—å–Ω–µ–µ",trend_down:"üìâ –°–ª–∞–±–µ–µ",trend_flat:"üìä –°—Ç–∞–±–∏–ª—å–Ω–æ",trend_desc:"–¢—Ä–µ–Ω–¥: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–∞—Ç—á–µ–π vs –æ—Å—Ç–∞–ª—å–Ω—ã–µ",elo_desc:"–¢–µ–∫—É—â–∏–π ELO (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)",modal_title:"–ü–æ–∏—Å–∫ ID",modal_btn_search:"–ü–æ–∏—Å–∫",modal_pname:"–ò–º—è",modal_pid:"ID",modal_use_id:"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å",modal_status_search:"–ü–æ–∏—Å–∫...",modal_status_none:"–ò–≥—Ä–æ–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",modal_status_found:"–ù–∞–π–¥–µ–Ω–æ {n} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",modal_status_err:"–û—à–∏–±–∫–∞: ",modal_match_title:"–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞ –ø–æ ID –º–∞—Ç—á–∞",modal_match_input_ph:"–í–≤–µ–¥–∏—Ç–µ ID –º–∞—Ç—á–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 184523)...",modal_match_btn_search:"–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É",modal_match_loading:"–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...",modal_match_err:"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ",kill:"–£–±–∏–π—Å—Ç–≤–∞",loss:"–ü–æ—Ç–µ—Ä–∏",obj:"–ó–∞—Ö–≤–∞—Ç",wcs_levels:{legendary:"üèÜ –õ–µ–≥–µ–Ω–¥–∞",elite:"üíé –≠–ª–∏—Ç–∞",good:"‚öîÔ∏è –ë–æ–µ—Ü",average:"üìä –°—Ä–µ–¥–Ω–∏–π",below:"‚ö†Ô∏è –ù–∏–∂–µ —Å—Ä–µ–¥–Ω.",poor:"üêõ –°–ª–∞–±–æ"},style_dims:{battlefield:"–ë–æ–π",combat:"–≠—Ñ—Ñ–µ–∫—Ç.",economy:"–≠–∫–æ–Ω–æ–º–∏–∫–∞",teamwork:"–ö–æ–º–∞–Ω–¥–∞",strategy:"–°—Ç—Ä–∞—Ç–µ–≥–∏—è",firepower:"–û–≥–æ–Ω—å"},tag_killer:"‚öîÔ∏è –£–±–∏–π—Ü–∞",tag_kd:"üìà KD",tag_obj:"üö© –ó–∞—Ö–≤–∞—Ç—á–∏–∫",res_vic:"–ü–û–ë–ï–î–ê",res_def:"–ü–û–†–ê–ñ–ï–ù–ò–ï",res_draw:"–ù–ò–ß–¨–Ø",meta_map:"–ö–∞—Ä—Ç–∞",meta_dur:"–í—Ä–µ–º—è",meta_win:"–ü–æ–±–µ–¥–∏—Ç–µ–ª—å",reasons:{1:"–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",2:"–í—Ä–µ–º—è/–°—á–µ—Ç",3:"–°–¥–∞—á–∞"},medals:{Destruction:"–£–±–∏–π—Ü–∞",Losses:"–ú–∏—à–µ–Ω—å",DamageDealt:"–ü—É—à–∫–∞",DamageReceived:"–ì—É–±–∫–∞",SupplyPointsConsumed:"–û–±–∂–æ—Ä–∞",SupplyPointsConsumedFromAllies:"–ü–∏—è–≤–∫–∞",SupplyPointsConsumedByAllies:"–ú–µ–¥–∏–∫",TotalSpawnedUnitScore:"–í–æ–µ–Ω–Ω–∞—è –º–∞—à–∏–Ω–∞",TotalRefundedUnitScore:"–ö–æ—Ä–æ–ª—å –≤–æ–∑–≤—Ä–∞—Ç–æ–≤"},medal_descs:{Destruction:"–ù–∞–∏–±–æ–ª—å—à–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å —É–Ω–∏—á—Ç–æ–∂–µ–Ω–Ω—ã—Ö –≤—Ä–∞–≥–æ–≤",Losses:"–ù–∞–∏–±–æ–ª—å—à–∏–µ –ø–æ—Ç–µ—Ä–∏",DamageDealt:"–ù–∞–∏–±–æ–ª—å—à–∏–π —É—Ä–æ–Ω",DamageReceived:"–ù–∞–∏–±–æ–ª—å—à–∏–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —É—Ä–æ–Ω",SupplyPointsConsumed:"–ù–∞–∏–±–æ–ª—å—à–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ",SupplyPointsConsumedFromAllies:"–ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –æ—Ç —Å–æ—é–∑–Ω–∏–∫–æ–≤",SupplyPointsConsumedByAllies:"–ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–ª—è —Å–æ—é–∑–Ω–∏–∫–æ–≤",TotalSpawnedUnitScore:"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã—Ö —é–Ω–∏—Ç–æ–≤",TotalRefundedUnitScore:"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–æ–≤"},lbl_fav_units_title:"–õ—é–±–∏–º—ã–µ —é–Ω–∏—Ç—ã (12 –º–∞—Ç—á–µ–π)",lbl_fav_dmg:"–ú–∞–∫—Å. —É—Ä–æ–Ω",lbl_fav_kill:"–£–±–∏–π—Ü–∞",lbl_fav_tank:"–¢–∞–Ω–∫",unit_dmg_title:"–ú–∞–∫—Å. —É—Ä–æ–Ω",unit_kill_title:"–£–±–∏–π—Ü–∞",unit_tank_title:"–¢–∞–Ω–∫",pd_dmg_dealt:"–£—Ä–æ–Ω",pd_dmg_taken:"–ü–æ–ª—É—á–µ–Ω–æ",pd_supply:"–ü—Ä–∏–ø–∞—Å—ã",pd_supply_ally:"–û—Ç —Å–æ—é–∑.",pd_supply_give:"–°–æ—é–∑–Ω–∏–∫–∞–º",pd_units:"–Æ–Ω–∏—Ç—ã"},Se={title:"BA Êà¶Ë°ìÂàÜÊûê",subtitle:"Broken Arrow Êà¶Á∏æÂàÜÊûê",placeholder:"Steam64 ID „Åæ„Åü„ÅØ „Ç≤„Éº„É†ÂÜÖID...",check:"ÂàÜÊûêÈñãÂßã",loading:"Ë™≠„ÅøËæº„Åø‰∏≠...",err_insufficient:"ÊúâÂäπ„Å™„Éû„ÉÉ„ÉÅ„Åå12Êà¶Êú™Ê∫Ä„Åß„Åô„ÄÇÊôÇÈñì„Çí„Åä„ÅÑ„Å¶ÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",find_id:"ID„ÅåÂàÜ„Åã„Çâ„Å™„ÅÑÔºü„É¶„Éº„Ç∂„ÉºÂêç„ÅßÊ§úÁ¥¢",find_match:"„Éû„ÉÉ„ÉÅID„ÅßÊ§úÁ¥¢",history_title:"Áõ¥Ëøë12Êà¶„ÅÆÊúâÂäπ„Éû„ÉÉ„ÉÅ",maggot_index_title:"ÂãùÂà©Ë≤¢ÁåÆÂ∫¶",god_range:"0",maggot_range:"100",lbl_ref_impact:"Êà¶Â†¥Ë≤¢ÁåÆ",lbl_ref_dr:"Êà¶ÈóòÂäπÁéá",lbl_ref_tr:"ÁµåÊ∏àÁÆ°ÁêÜ",lbl_ref_or:"„ÉÅ„Éº„É†„ÉØ„Éº„ÇØ",lbl_ref_wr:"ÂãùÁéá",trend_up:"üöÄ Ë™øÂ≠ê‰∏äÊòá‰∏≠",trend_down:"üìâ „Çπ„É©„É≥„Éó‰∏≠",trend_flat:"üìä ÂÆâÂÆö",trend_desc:"Áõ¥Ëøë6Ë©¶Âêà„Å®„Åù„Çå‰ª•Ââç„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊØîËºÉ",elo_desc:"ÁèæÂú®„ÅÆELO„É¨„Éº„Éà („É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞)",modal_title:"„Éó„É¨„Ç§„É§„ÉºIDÊ§úÁ¥¢",modal_btn_search:"Ê§úÁ¥¢",modal_pname:"„Éó„É¨„Ç§„É§„ÉºÂêç",modal_pid:"ÂÜÖÈÉ®ID",modal_use_id:"„Åì„ÅÆID„Çí‰ΩøÁî®",modal_status_search:"Ê§úÁ¥¢‰∏≠...",modal_status_none:"„Éó„É¨„Ç§„É§„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",modal_status_found:"{n}‰ª∂„ÅÆÁµêÊûú",modal_status_err:"„Ç®„É©„Éº: ",modal_match_title:"„Éû„ÉÉ„ÉÅIDÊ§úÁ¥¢",modal_match_input_ph:"„Éû„ÉÉ„ÉÅID„ÇíÂÖ•Âäõ (‰æã: 184523)...",modal_match_btn_search:"Êà¶Á∏æÂèñÂæó",modal_match_loading:"„Éá„Éº„ÇøÂèñÂæó‰∏≠...",modal_match_err:"ÊÉÖÂ†±„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü",kill:"ÊíÉÁ†¥",loss:"ÊêçÂ§±",obj:"Âç†È†ò",wcs_levels:{legendary:"üèÜ ‰ºùË™¨",elite:"üíé „Ç®„É™„Éº„Éà",good:"‚öîÔ∏è ÁÜüÁ∑¥",average:"üìä Âπ≥Âùá",below:"‚ö†Ô∏è Âπ≥Âùá‰ª•‰∏ã",poor:"üêõ Âú∞Èõ∑"},style_dims:{battlefield:"Êà¶Â†¥",combat:"Êà¶Èóò",economy:"ÁµåÊ∏à",teamwork:"ÂçîÂäõ",strategy:"Êà¶Áï•",firepower:"ÁÅ´Âäõ"},tag_killer:"‚öîÔ∏è „Ç¢„Çø„ÉÉ„Ç´„Éº",tag_kd:"üìà KDÂûã",tag_obj:"üö© Êã†ÁÇπÂûã",res_vic:"ÂãùÂà©",res_def:"ÊïóÂåó",res_draw:"ÂºïÂàÜ",meta_map:"„Éû„ÉÉ„Éó",meta_dur:"ÊôÇÈñì",meta_win:"ÂãùËÄÖ",reasons:{1:"ÂúßÂÄí",2:"Âà§ÂÆö",3:"Èôç‰ºè"},medals:{Destruction:"ÊíÉÁ†¥Áéã",Losses:"ÁâπÊîªÈöäÈï∑",DamageDealt:"ÁÅ´ÂäõÁéã",DamageReceived:"„Çø„É≥„ÇØÁéã",SupplyPointsConsumed:"Â§ßÈ£ü„ÅÑ",SupplyPointsConsumedFromAllies:"„Åü„Åã„ÇäÂ±ã",SupplyPointsConsumedByAllies:"Ë°õÁîüÂÖµ",TotalSpawnedUnitScore:"Â§ßÂ∞ÜËªç",TotalRefundedUnitScore:"„É™„Éï„Ç°„É≥„ÉâÁéã"},medal_descs:{Destruction:"ÊíÉÁ†¥„Çπ„Ç≥„Ç¢„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",Losses:"ÊêçÂ§±„Çπ„Ç≥„Ç¢„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",DamageDealt:"‰∏é„ÉÄ„É°„Éº„Ç∏„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",DamageReceived:"Ë¢´„ÉÄ„É°„Éº„Ç∏„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",SupplyPointsConsumed:"Ë£úÁµ¶Ê∂àË≤ª„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",SupplyPointsConsumedFromAllies:"Âë≥Êñπ„Åã„Çâ„ÅÆË£úÁµ¶„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",SupplyPointsConsumedByAllies:"Âë≥Êñπ„Å∏„ÅÆË£úÁµ¶„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",TotalSpawnedUnitScore:"„É¶„Éã„ÉÉ„ÉàÈÖçÂÇôÁ∑èÈ°ç„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö",TotalRefundedUnitScore:"„É¶„Éã„ÉÉ„ÉàÂ£≤Âç¥Á∑èÈ°ç„Åå„ÉÅ„Éº„É†ÂÜÖÊúÄÂ§ö"},lbl_fav_units_title:"ÊÑõÁî®„É¶„Éã„ÉÉ„Éà (Áõ¥Ëøë12Êà¶)",lbl_fav_dmg:"ÊúÄÂ§ß„ÉÄ„É°„Éº„Ç∏",lbl_fav_kill:"„Éà„ÉÉ„Éó„Ç≠„É´",lbl_fav_tank:"„Éà„ÉÉ„Éó„Çø„É≥„ÇØ",unit_dmg_title:"ÊúÄÂ§ß„ÉÄ„É°„Éº„Ç∏",unit_kill_title:"„Éà„ÉÉ„Éó„Ç≠„É´",unit_tank_title:"„Éà„ÉÉ„Éó„Çø„É≥„ÇØ",pd_dmg_dealt:"‰∏é„ÉÄ„É°„Éº„Ç∏",pd_dmg_taken:"Ë¢´„ÉÄ„É°„Éº„Ç∏",pd_supply:"Ë£úÁµ¶‰ΩøÁî®",pd_supply_ally:"Âë≥ÊñπË£úÁµ¶‰ΩøÁî®",pd_supply_give:"Âë≥Êñπ„Å∏Ë£úÁµ¶",pd_units:"„É¶„Éã„ÉÉ„ÉàÁ∑èÈ°ç"},re={zh:we,en:ve,ru:xe,ja:Se};let N="zh";function de(e){N=e,document.querySelectorAll('[id^="btn_lang_"]').forEach(t=>{t.classList.toggle("bg-cyan-600",t.id===`btn_lang_${e}`),t.classList.toggle("text-white",t.id===`btn_lang_${e}`),t.classList.toggle("text-slate-400",t.id!==`btn_lang_${e}`)}),ke()}function Ie(){return N}function R(){return re[N]}function ke(){const e=re[N],t=(a,o)=>{const l=document.getElementById(a);l&&(l.innerText=o)},n=(a,o,l)=>{const r=document.getElementById(a);r&&r.setAttribute(o,l)};t("lbl_title",e.title),t("lbl_subtitle",e.subtitle),n("steamInput","placeholder",e.placeholder),t("btn_check",e.check),t("lbl_find_id_btn",e.find_id),t("lbl_find_match_btn",e.find_match),t("lbl_history_title",e.history_title),t("lbl_maggot_index_title",e.maggot_index_title),t("lbl_god_range",e.god_range),t("lbl_maggot_range",e.maggot_range),t("lbl_ref_impact",e.lbl_ref_impact),t("lbl_ref_dr",e.lbl_ref_dr),t("lbl_ref_tr",e.lbl_ref_tr),t("lbl_ref_or",e.lbl_ref_or),t("lbl_ref_wr",e.lbl_ref_wr),t("modal_title",e.modal_title),t("modal_btn_search",e.modal_btn_search),t("lbl_modal_pname",e.modal_pname),t("lbl_modal_pid",e.modal_pid),t("btn_use_id",e.modal_use_id),n("modalSearchInput","placeholder",e.placeholder),t("modal_match_title",e.modal_match_title),n("matchIdInput","placeholder",e.modal_match_input_ph),t("modal_match_btn_search",e.modal_match_btn_search),t("lbl_pd_kill",e.kill),t("lbl_pd_loss",e.loss),t("lbl_pd_obj",e.obj),t("lbl_pd_dmg_dealt",e.pd_dmg_dealt),t("lbl_pd_dmg_taken",e.pd_dmg_taken),t("lbl_pd_supply",e.pd_supply),t("lbl_pd_supply_ally",e.pd_supply_ally),t("lbl_pd_supply_give",e.pd_supply_give),t("lbl_pd_units",e.pd_units),t("lbl_pd_top_dmg",e.unit_dmg_title),t("lbl_pd_top_kill",e.unit_kill_title),t("lbl_pd_top_tank",e.unit_tank_title)}function Te(e){let t;return(t=e.match(/stb\/commander\/([^/]+)\/steam$/))?{url:`${S.BATRACE_BASE}/steam/player/${t[1]}`,transform:n=>n.data||n}:(t=e.match(/stb\/commander\/(\d+)\/matches/))?{url:`${S.BATRACE_BASE}/stb/matchlistid_by_stbId?stbId=${t[1]}`,transform:n=>n}:(t=e.match(/stb\/match\/(\d+)/))?{url:`${S.BATRACE_BASE}/stb/match_by_matchid?match_id=${t[1]}`,transform:n=>n}:null}async function P(e,t=0){if(t===0){const a=Te(e);if(a)try{const o=await fetch(a.url);if(o.ok){const l=await o.json();return a.transform(l)}}catch{}}const n=S.PROXIES[t%S.PROXIES.length];try{const a=n.url(e),o=await fetch(a);if(!o.ok)throw new Error(`HTTP_${o.status}`);const l=await o.json();return l.contents?typeof l.contents=="string"?JSON.parse(l.contents):l.contents:l}catch(a){if(t<4)return P(e,t+1);throw a}}async function De(e){let t=e,n=null;return(e.length>10||isNaN(e))&&(n=await P(`${S.BARMORY_BASE}/stb/commander/${e}/steam`),t=String(n.id)),{uid:t,userData:n}}async function Ee(e){const t=new Date().toISOString().split("T")[0]+"_"+new Date().getHours().toString().padStart(2,"0");return P(`${S.BARMORY_BASE}/stb/commander/${e}/matches?time=${t}`)}async function Le(e){return P(`${S.BARMORY_BASE}/stb/match/${e}`)}async function Me(e){const t=`https://batrace.aoeiaol.top/api/v1/search/players?q=${encodeURIComponent(e)}&limit=20`,n=await fetch(t);if(!n.ok)throw new Error("API Request Failed");return(await n.json()).results||[]}const ae=S.LS_UNIT_CACHE_KEY,oe=S.LS_UNIT_CACHE_TS;let ce={},me=!1;function V(e){Array.isArray(e)&&(e.forEach(t=>{const n=t.Id||t.id,a=t.Name||t.name;n&&a&&(ce[n]=a)}),me=!0)}async function ue(){if(me)return;const e=Date.now(),t=localStorage.getItem(ae),n=localStorage.getItem(oe),a=1440*60*1e3;if(t&&n&&e-parseInt(n)<a)try{const o=JSON.parse(t);V(o),console.log("Unit Library loaded from Cache");return}catch{console.warn("Cache corrupted, fetching fresh data")}try{const o=await fetch(`${S.BATRACE_BASE}/Units`);if(!o.ok)throw new Error("Unit API Failed");const l=await o.json();localStorage.setItem(ae,JSON.stringify(l)),localStorage.setItem(oe,e.toString()),V(l),console.log("Unit Library loaded from API")}catch(o){if(console.warn("Failed to load unit library:",o),t)try{V(JSON.parse(t)),console.log("Unit Library loaded from STALE Cache")}catch{}}}function A(e){return ce[e]||`Unit ${e}`}const ge=[{key:"Destruction",icon:"‚öîÔ∏è",color:"text-red-400"},{key:"Losses",icon:"‚ò†Ô∏è",color:"text-gray-400"},{key:"DamageDealt",icon:"üí•",color:"text-orange-400"},{key:"DamageReceived",icon:"üß±",color:"text-slate-400"},{key:"SupplyPointsConsumed",icon:"üçî",color:"text-yellow-400"},{key:"SupplyPointsConsumedFromAllies",icon:"üê±",color:"text-pink-400"},{key:"SupplyPointsConsumedByAllies",icon:"üöë",color:"text-green-400"},{key:"TotalSpawnedUnitScore",icon:"üõí",color:"text-blue-400"},{key:"TotalRefundedUnitScore",icon:"üí∏",color:"text-emerald-400"}];function le(e){ge.forEach(t=>{const n=Math.max(...e.map(a=>a.rawData[t.key]||0));n>0&&e.forEach(a=>{(a.rawData[t.key]||0)===n&&a.medals.push({...t,val:n})})})}function $e(e,t){if(t.length<=1)return 50;const n=t.filter(o=>o<e).length,a=t.filter(o=>o===e).length;return(n+a*.5)/t.length*100}function D(e,t,n=0){return t>0?e/t:n}function Be(e){let t=0,n=0,a=new Set,o={id:0,v:-1},l={id:0,v:-1},r={id:0,v:-1};if(!e)return{buildingsDestroyed:t,selfDamage:n,unitTypes:a,topD:o,topK:l,topT:r};const d={};return Object.values(e).forEach(i=>{i.Id&&(a.add(i.Id),t+=i.BuildingDestroyedCount||0,n+=i.TotalSelfDamageDealt||0,d[i.Id]||(d[i.Id]={d:0,k:0,t:0}),d[i.Id].d+=i.TotalDamageDealt||0,d[i.Id].k+=i.KilledCount||0,d[i.Id].t+=i.TotalDamageReceived||0)}),Object.entries(d).forEach(([i,c])=>{c.d>o.v&&(o={id:i,v:c.d}),c.k>l.v&&(l={id:i,v:c.k}),c.t>r.v&&(r={id:i,v:c.t})}),{buildingsDestroyed:t,selfDamage:n,unitTypes:a,topD:o,topK:l,topT:r}}function Ce(e,t){const n={};let a=0,o=0;const l={battlefield:0,combat:0,economy:0,teamwork:0,strategy:0,firepower:0},r={battlefield:0,combat:0,economy:0,teamwork:0,strategy:0,firepower:0},d=t.map(_=>{const w=_.data.Data,p=_.data;let k=0,I=0,v=0,L=0;Object.values(w).forEach(s=>{if(s.Name){const u=(s.NewRating||0)-(s.OldRating||0);s.TeamId===1?(k+=u,I++):(v+=u,L++)}});const H=I>0?k/I:0,U=L>0?v/L:0,M=Object.entries(w).map(([s,u])=>{if(u.Id||(u.Id=s),u.Name)u.TeamId=u.TeamId===1?1:0;else{u.Name="Unknown";const y=(u.NewRating||0)-(u.OldRating||0);u.TeamId=Math.abs(y-H)<Math.abs(y-U)||I===0&&L===0&&y>=0?1:0}return u});if(p.WinnerTeam===void 0){let s=0,u=0;M.forEach(y=>{if(y.NewRating!==void 0&&y.OldRating!==void 0){const x=y.NewRating-y.OldRating;y.TeamId===0?s+=x:u+=x}}),p.WinnerTeam=s>u?0:1}const ee=M.find(s=>String(s.Id)===String(e)),K=ee?ee.TeamId:p.WinnerTeam===0?1:0,W=p.WinnerTeam===101,z=!W&&K===p.WinnerTeam;z&&a++;const $={0:{dmg:0,dest:0,loss:0,spawn:0},1:{dmg:0,dest:0,loss:0,spawn:0}};M.forEach(s=>{const u=s.TeamId===1?1:0;$[u].dmg+=s.DamageDealt||0,$[u].dest+=s.DestructionScore||0,$[u].loss+=s.LossesScore||0,$[u].spawn+=s.TotalSpawnedUnitScore||0});const B=M.map(s=>{const u=s.TeamId===1?1:0,y=Math.max((s.TotalSpawnedUnitScore||0)-(s.TotalRefundedUnitScore||0),1),x=Be(s.UnitData);return{id:s.Id,teamId:u,teamLossShare:D(s.LossesScore||0,Math.max($[u].loss,1)),teamDmgShare:D(s.DamageDealt||0,Math.max($[u].dmg,1)),teamDestShare:D(s.DestructionScore||0,Math.max($[u].dest,1)),dlRatio:s.DLRatio||D(s.DestructionScore||0,Math.max(s.LossesScore||0,1)),survivalRate:Math.max(0,1-D(s.LossesScore||0,y)),damageTrade:D(s.DamageDealt||0,Math.max(s.DamageReceived||0,1)),costEfficiency:D(s.DestructionScore||0,y),refundRate:D(s.TotalRefundedUnitScore||0,Math.max(s.TotalSpawnedUnitScore||0,1)),totalRefunded:s.TotalRefundedUnitScore||0,uniqueUnits:x.unitTypes.size,supplyFromAllies:s.SupplyPointsConsumedFromAllies||0,supplyToAllies:s.SupplyPointsConsumedByAllies||0,objectivesCaptured:s.ObjectivesCaptured||0,supplyCaptured:s.SupplyCaptured||0,buildingsDestroyed:x.buildingsDestroyed,damageDealt:s.DamageDealt||0,destructionScore:s.DestructionScore||0,netInvestment:y,damageReceived:s.DamageReceived||0,objectivesRaw:s.ObjectivesCaptured||0,supplyGiven:s.SupplyPointsConsumedByAllies||0,unitDiversity:x.unitTypes.size,selfDamage:x.selfDamage,topD:x.topD,topK:x.topK,topT:x.topT}}),T=(s,u)=>$e(s,B.map(y=>y[u])),b=B.find(s=>String(s.id)===String(e)),C=S.WCS_WEIGHTS;let Y=50;const E={battlefield:50,combat:50,economy:50,teamwork:50,strategy:50,firepower:50};if(b){E.battlefield=(T(b.teamLossShare,"teamLossShare")+T(b.teamDmgShare,"teamDmgShare")+T(b.teamDestShare,"teamDestShare"))/3,E.combat=(T(b.dlRatio,"dlRatio")+T(b.survivalRate,"survivalRate")+T(b.damageTrade,"damageTrade")+T(b.costEfficiency,"costEfficiency"))/4,E.economy=(T(b.refundRate,"refundRate")+T(b.totalRefunded,"totalRefunded"))/2,E.teamwork=(T(b.uniqueUnits,"uniqueUnits")+T(b.supplyFromAllies,"supplyFromAllies")+T(b.supplyToAllies,"supplyToAllies"))/3,E.strategy=(T(b.objectivesCaptured,"objectivesCaptured")+T(b.supplyCaptured,"supplyCaptured")+T(b.buildingsDestroyed,"buildingsDestroyed"))/3,E.firepower=(T(b.damageDealt,"damageDealt")+T(b.destructionScore,"destructionScore"))/2;const s=z?100:W?50:0;Y=C.battlefield*E.battlefield+C.combat*E.combat+C.economy*E.economy+C.teamwork*E.teamwork+C.strategy*E.strategy+C.firepower*E.firepower+C.winBonus*s,o+=Y,Object.keys(l).forEach(y=>{l[y]+=E[y]});const u=y=>B.reduce((x,J)=>x+J[y],0)/B.length||1;r.battlefield+=D((b.teamLossShare+b.teamDmgShare+b.teamDestShare)/3,B.reduce((y,x)=>y+x.teamLossShare+x.teamDmgShare+x.teamDestShare,0)/B.length/3,1),r.combat+=D(b.dlRatio,u("dlRatio"),1),r.economy+=D(b.refundRate,u("refundRate"),1),r.teamwork+=D(b.uniqueUnits,u("uniqueUnits"),1),r.strategy+=D(b.objectivesCaptured,u("objectivesCaptured"),1),r.firepower+=D(b.damageDealt,u("damageDealt"),1)}const ye=Math.max(...M.map(s=>s.DestructionScore||0),1),he=Math.max(...M.map(s=>s.LossesScore||0),1),be=Math.max(...M.map(s=>s.ObjectivesCaptured||0),1),te=s=>{const u=s.DestructionScore||0,y=s.LossesScore||0,x=B.find(J=>String(J.id)===String(s.Id));return{id:s.Id,name:s.Name,elo:s.NewRating?s.NewRating.toFixed(0):"N/A",gain:s.NewRating&&s.OldRating?(s.NewRating-s.OldRating).toFixed(1):"0.0",kPct:u/ye*100,lPct:y/he*100,oPct:(s.ObjectivesCaptured||0)/be*100,isMe:String(s.Id)===String(e),score:(u-y)/1e3+(s.ObjectivesCaptured||0),kScore:u,lScore:y,oScore:s.ObjectivesCaptured||0,kd:D(u,y||1),rawData:s,medals:[],favUnits:x?{d:x.topD,k:x.topK,t:x.topT}:{d:{id:0,v:-1},k:{id:0,v:-1},t:{id:0,v:-1}},selfDamage:x?x.selfDamage:0}},G=M.filter(s=>s.TeamId===K).map(te).sort((s,u)=>u.score-s.score),ne=M.filter(s=>s.TeamId!==K).map(te).sort((s,u)=>u.score-s.score);le(G),le(ne);const q=G.find(s=>s.isMe);return q&&q.medals&&q.medals.forEach(s=>{n[s.key]=(n[s.key]||0)+1}),{id:_.id,wcs:Y,wcsBreakdown:E,ally:G,enemy:ne,isWin:z,isDraw:W,endReason:p.EndMatchReason,endTime:p.EndTime,mapId:p.MapId,duration:p.TotalPlayTimeInSec,winnerTeam:p.WinnerTeam}}),i=t.length,c=o/i,m={};Object.keys(l).forEach(_=>{m[_]=l[_]/i});const f=Re(r,i),g=Object.entries(n).sort((_,w)=>w[1]-_[1]).slice(0,2).map(_=>_[0]),h=S.WCS_LEVELS.find(_=>c>=_.min)||S.WCS_LEVELS[S.WCS_LEVELS.length-1];return{stats:d,wcs:c,wcsBreakdown:m,wcsLevel:h,playstyle:f,wins:a,winRate:Math.round(a/i*100),topMedals:g}}const se=[{keys:["battlefield","combat"],icon:"üó°Ô∏è",zh:"ÈìÅÊã≥Á™ÅÂáªÊâã",en:"Iron Fist"},{keys:["combat","economy"],icon:"üõ°Ô∏è",zh:"Á≤æÁÆóÊåáÊå•ÂÆò",en:"Tactician"},{keys:["teamwork","battlefield"],icon:"üöë",zh:"Âõ¢ÈòüÊ†∏ÂøÉ",en:"Team Core"},{keys:["strategy","battlefield"],icon:"üéØ",zh:"ÁõÆÊ†áÁåéÊâã",en:"Obj Hunter"},{keys:["battlefield","firepower"],icon:"üí™",zh:"ÂâçÁ∫øÂéãÂà∂Êâã",en:"Frontliner"},{keys:["economy","teamwork"],icon:"üîÑ",zh:"ÂêéÂã§Â§ßÂ∏à",en:"Logistics"},{keys:["firepower","combat"],icon:"üî•",zh:"ÁÅ´ÂäõÁãÇ‰∫∫",en:"Berserker"},{keys:["battlefield"],icon:"‚öîÔ∏è",zh:"ÊàòÂú∫‰∏ªÂÆ∞",en:"Dominator"},{keys:["combat"],icon:"üíé",zh:"ÊïàÁéáÂ§ßÂ∏à",en:"Efficient"},{keys:["teamwork"],icon:"ü§ù",zh:"Âçè‰Ωú‰∏ìÂÆ∂",en:"Collaborator"},{keys:["strategy"],icon:"üèÅ",zh:"Êä¢ÁÇπ‰∏ìÂÆ∂",en:"Point Rush"},{keys:["firepower"],icon:"üí•",zh:"ÈáçÁÅ´Âäõ",en:"Heavy Fire"},{keys:["economy"],icon:"üí∞",zh:"ÁêÜË¥¢Â§ßÂ∏à",en:"Economist"}];function Re(e,t){const n={};Object.keys(e).forEach(i=>{const c=e[i]/t;n[i]=Math.min(100,Math.round(c*50))});const a={battlefield:"‚öîÔ∏è",combat:"üíé",economy:"üí∞",teamwork:"ü§ù",strategy:"üèÅ",firepower:"üî•"},o=Object.keys(n).map(i=>({key:i,value:n[i],icon:a[i]||"üìä"})),r=[...o].sort((i,c)=>c.value-i.value).slice(0,2).map(i=>i.key);let d=se.find(i=>i.keys.every(c=>r.includes(c)));return d||(d=se.find(i=>i.keys.length===1&&i.keys[0]===r[0])),d||(d={icon:"üìä",zh:"ÂùáË°°Âûã",en:"Balanced"}),{dimensions:o,label:d.zh,labelEn:d.en,labelIcon:d.icon}}function Ae(e,t){const n={};e.forEach(d=>{const i=d.data.Data[t];!i||!i.UnitData||Object.values(i.UnitData).forEach(c=>{const m=c.Id;m&&(n[m]||(n[m]={id:m,damageDealt:0,kills:0,damageReceived:0}),n[m].damageDealt+=c.TotalDamageDealt||0,n[m].kills+=c.KilledCount||0,n[m].damageReceived+=c.TotalDamageReceived||0)})});const a=Object.values(n);if(a.length===0)return null;const o=[...a].sort((d,i)=>i.damageDealt-d.damageDealt)[0],l=[...a].sort((d,i)=>i.kills-d.kills)[0],r=[...a].sort((d,i)=>i.damageReceived-d.damageReceived)[0];return{topDmg:o,topKill:l,topTank:r}}function Pe(e){const t=Math.floor(e/60),n=e%60;return`${t}m ${n}s`}function Ue(e){const t=new Date(e*1e3),n=a=>a.toString().padStart(2,"0");return`${t.getFullYear()}-${n(t.getMonth()+1)}-${n(t.getDate())} ${n(t.getHours())}:${n(t.getMinutes())}`}function j(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}let _e=[];function O(e,t,n){document.getElementById("loadPercent").innerText=e+"%",document.getElementById("loadProgressFill").style.width=e+"%",document.getElementById("loadStatus").innerText=t,document.getElementById("loadDetail").innerText=n}function Oe(e){var k;const{stats:t,wcs:n,wcsBreakdown:a,wcsLevel:o,playstyle:l,winRate:r,topMedals:d}=e,i=R();_e=t,document.getElementById("resultPanel").classList.remove("hidden");const c=document.getElementById("maggotScoreDisplay");c.innerText=n.toFixed(1),c.style.color=n>=65?"#4ade80":n>=40?"#facc15":"#f87171";const m=((k=i.wcs_levels)==null?void 0:k[o.key])||o.key;document.getElementById("maggotLabel").innerText=m,document.getElementById("meterIndicator").style.left=`${Math.min(n,100)}%`,document.getElementById("ref_avgImpact").innerText=a.battlefield.toFixed(1),document.getElementById("ref_avgDR").innerText=a.combat.toFixed(1),document.getElementById("ref_avgTR").innerText=a.economy.toFixed(1),document.getElementById("ref_avgOR").innerText=a.teamwork.toFixed(1),document.getElementById("ref_avgST").innerText=a.strategy.toFixed(1),document.getElementById("ref_avgFP").innerText=a.firepower.toFixed(1),document.getElementById("ref_WR").innerText=r+"%";const f=i.wcs_tips||{battlefield:`Team loss share + Team damage share + Team destruction share
Weight: 29%`,combat:`D/L Ratio + Survival Rate + Damage Trade + Cost Efficiency
Weight: 16%`,economy:`Refund Rate + Total Refunded
Weight: 16%`,teamwork:`Unit Diversity + Supply From/To Allies
Weight: 10%`,strategy:`Objectives + Supply Captured + Buildings Destroyed
Weight: 8%`,firepower:`Damage Dealt + Destruction Score
Weight: 6%`};Object.entries(f).forEach(([I,v])=>{const L=document.getElementById(`tip_${I}`);L&&(L.innerText=v)}),Fe(d);const g=document.querySelector(".tag-sticker-container"),h=t.slice(0,3).reduce((I,v)=>I+v.wcs,0)/3,_=t.slice(3).reduce((I,v)=>I+v.wcs,0)/Math.max(t.length-3,1),w=h>_+3?i.trend_up||"üìà ‰∏äÂçáË∂ãÂäø":h<_-3?i.trend_down||"üìâ ‰∏ãÈôçË∂ãÂäø":i.trend_flat||"‚û°Ô∏è Á®≥ÂÆöÂèëÊå•",p=document.createElement("div");if(p.title=i.trend_desc||"Performance trend",p.className="tag-sticker bg-slate-600/20 border-slate-500/50 text-slate-300 cursor-help",p.innerText=w,g.appendChild(p),t.length>0){const I=t[0].ally.find(v=>v.isMe);if(I){const v=document.createElement("div");v.title=i.elo_desc||"Current ELO",v.className="tag-sticker bg-violet-600/20 border-violet-500/50 text-violet-300 font-mono cursor-help",v.innerHTML=`ELO ${I.elo}`,g.appendChild(v)}}Ne(l),document.getElementById("matchesContainer").innerHTML=t.map(I=>He(I,i)).join("")}function Ne(e){const t=R(),n=document.getElementById("playstyleSection");if(!n)return;n.classList.remove("hidden"),document.getElementById("playstyleLabel").innerHTML=`<span class="text-3xl mr-2">${e.labelIcon}</span><span>${e.label}</span>`;const a=document.getElementById("playstyleRadar");a.innerHTML=je(e.dimensions,t);const o=document.getElementById("playstyleBars");o.innerHTML=e.dimensions.map(l=>{var i;const r=((i=t.style_dims)==null?void 0:i[l.key])||l.key,d=l.value>=60?"bg-cyan-500":l.value>=40?"bg-yellow-500":"bg-slate-500";return`
    <div class="flex items-center gap-3">
      <span class="text-lg w-6 text-center">${l.icon}</span>
      <span class="text-[11px] text-slate-400 w-16 uppercase font-bold truncate">${r}</span>
      <div class="flex-1 h-2 bg-slate-700 rounded-full overflow-hidden">
        <div class="${d} h-full rounded-full transition-all duration-700" style="width:${l.value}%"></div>
      </div>
      <span class="text-xs font-mono font-bold text-slate-300 w-8 text-right">${l.value}</span>
    </div>`}).join("")}function je(e,t){const l=e.length,r=2*Math.PI/l,d=[.25,.5,.75,1].map(g=>`<polygon points="${Array.from({length:l},(_,w)=>{const p=-Math.PI/2+w*r;return`${100+70*g*Math.cos(p)},${100+70*g*Math.sin(p)}`}).join(" ")}" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>`).join(""),i=Array.from({length:l},(g,h)=>{const _=-Math.PI/2+h*r;return`<line x1="100" y1="100" x2="${100+70*Math.cos(_)}" y2="${100+70*Math.sin(_)}" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>`}).join(""),c=e.map((g,h)=>{const _=-Math.PI/2+h*r,w=Math.min(g.value,100)/100;return`${100+70*w*Math.cos(_)},${100+70*w*Math.sin(_)}`}).join(" "),m=e.map((g,h)=>{const _=-Math.PI/2+h*r,w=Math.min(g.value,100)/100,p=100+70*w*Math.cos(_),k=100+70*w*Math.sin(_);return`<circle cx="${p}" cy="${k}" r="3" fill="#06b6d4" stroke="white" stroke-width="1"/>`}).join(""),f=e.map((g,h)=>{var v;const _=-Math.PI/2+h*r,w=100+92*Math.cos(_),p=100+92*Math.sin(_),k=((v=t.style_dims)==null?void 0:v[g.key])||g.key,I=Math.abs(Math.cos(_))<.3?"middle":Math.cos(_)>0?"start":"end";return`<text x="${w}" y="${p}" fill="#94a3b8" text-anchor="${I}" dominant-baseline="middle" font-size="9" font-weight="bold">${g.icon} ${k}</text>`}).join("");return`<svg viewBox="0 0 200 200" class="w-full h-full max-w-[240px] mx-auto">
    ${d}${i}
    <polygon points="${c}" fill="rgba(6,182,212,0.2)" stroke="rgba(6,182,212,0.8)" stroke-width="2"/>
    ${m}${f}
  </svg>`}function Fe(e){const t=R(),n=document.querySelector(".tag-sticker-container");n.innerHTML="";const a={red:"bg-red-600/20 border-red-500/50 text-red-300",orange:"bg-orange-600/20 border-orange-500/50 text-orange-300",yellow:"bg-yellow-600/20 border-yellow-500/50 text-yellow-300",green:"bg-green-600/20 border-green-500/50 text-green-300",emerald:"bg-emerald-600/20 border-emerald-500/50 text-emerald-300",blue:"bg-blue-600/20 border-blue-500/50 text-blue-300",pink:"bg-pink-600/20 border-pink-500/50 text-pink-300",slate:"bg-slate-600/20 border-slate-500/50 text-slate-300",gray:"bg-gray-600/20 border-gray-500/50 text-gray-300"};e.forEach(o=>{var f,g;const l=ge.find(h=>h.key===o);if(!l)return;const r=((f=t.medals)==null?void 0:f[o])||o,d=((g=t.medal_descs)==null?void 0:g[o])||r,i=l.color.replace("text-","").replace("-400",""),c=a[i]||a.gray,m=document.createElement("div");m.title=d,m.className=`tag-sticker ${c} flex items-center gap-2 cursor-help`,m.innerHTML=`<span class="text-lg">${l.icon}</span><span>${r}</span>`,n.appendChild(m)})}function He(e,t){var m,f,g,h,_,w,p,k;const n=((m=t.reasons)==null?void 0:m[e.endReason])||((f=t.reasons)==null?void 0:f[1])||"",a=Ue(e.endTime),o=Pe(e.duration);let l,r;e.isDraw?(l="bg-slate-600/30 text-slate-300 border border-slate-500/30",r=t.res_draw):(l=e.isWin?"bg-cyan-600/20 text-cyan-400":"bg-red-600/20 text-red-400",r=e.isWin?t.res_vic:t.res_def);const d=e.wcs>=65?"text-green-400":e.wcs>=40?"text-yellow-400":"text-red-400",c=[{key:"battlefield",label:((g=t.style_dims)==null?void 0:g.battlefield)||"‚öîÔ∏è",color:"#06b6d4"},{key:"combat",label:((h=t.style_dims)==null?void 0:h.combat)||"üíé",color:"#fb923c"},{key:"economy",label:((_=t.style_dims)==null?void 0:_.economy)||"üí∞",color:"#4ade80"},{key:"teamwork",label:((w=t.style_dims)==null?void 0:w.teamwork)||"ü§ù",color:"#a78bfa"},{key:"strategy",label:((p=t.style_dims)==null?void 0:p.strategy)||"üèÅ",color:"#34d399"},{key:"firepower",label:((k=t.style_dims)==null?void 0:k.firepower)||"üî•",color:"#f87171"}].map(I=>{var U;const v=((U=e.wcsBreakdown)==null?void 0:U[I.key])??50,L=Math.min(v,100),H=v>=60?I.color:v>=40?"#94a3b8":"#ef4444";return`<div class="flex items-center gap-1 flex-1 min-w-0" title="${I.label}: ${v.toFixed(0)}">
      <span class="text-[8px] md:text-[9px] text-slate-500 w-4 md:w-12 text-right truncate font-bold">${I.label}</span>
      <div class="flex-1 h-1.5 bg-slate-800 rounded-full overflow-hidden">
        <div class="h-full rounded-full transition-all" style="width:${L}%;background:${H};opacity:0.8"></div>
      </div>
      <span class="text-[8px] font-mono text-slate-500 w-5 text-right">${v.toFixed(0)}</span>
    </div>`}).join("");return`
  <div class="glass-panel rounded-[2rem] md:rounded-[3rem] overflow-hidden border-white/10 shadow-2xl">
    <div class="bg-white/5 px-4 py-3 md:px-8 md:py-4 flex flex-col md:flex-row justify-between items-start md:items-center text-[10px] md:text-xs font-bold font-mono text-slate-400 gap-2 md:gap-0">
      <div class="flex flex-wrap items-center gap-2 md:gap-4 leading-relaxed">
        <span class="whitespace-nowrap">ID: ${e.id}</span>
        <span class="w-px h-3 bg-white/10 hidden md:block"></span>
        <span>${a}</span>
        <span class="w-px h-3 bg-white/10 hidden md:block"></span>
        <span>${t.meta_map||"Map"} ${e.mapId}</span>
        <span class="w-px h-3 bg-white/10 hidden md:block"></span>
        <span>${o}</span>
        <span class="w-px h-3 bg-white/10 hidden md:block"></span>
        <span class="whitespace-nowrap">${n}</span>
      </div>
      <span class="px-3 py-1 md:px-4 md:py-1 ${l} rounded-lg font-black uppercase tracking-widest flex items-center gap-2 self-end md:self-auto">
        <span class="${d}">WCS ${e.wcs.toFixed(1)}</span>
        <span class="opacity-50">/</span>
        <span>${r}</span>
      </span>
    </div>
    <div class="bg-white/3 px-4 py-1.5 md:px-8 md:py-2 flex gap-2 md:gap-3 border-t border-white/5">
      ${c}
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-px bg-white/10">
      <div class="bg-[#0f172a] p-2 md:p-4">${ie(e.ally,e.id)}</div>
      <div class="bg-[#0f172a] p-2 md:p-4">${ie(e.enemy,e.id)}</div>
    </div>
  </div>`}function ie(e,t){const n=R();return e.map(a=>{const o=`${n.kill||"Kill"}: ${a.kScore.toLocaleString()} | ${n.loss||"Loss"}: ${a.lScore.toLocaleString()} | ${n.obj||"Obj"}: ${a.oScore}`,l=a.medals.length>0?`<div class="flex flex-wrap gap-1 mt-1.5">${a.medals.map(d=>{var c;const i=((c=n.medals)==null?void 0:c[d.key])||d.key;return`<div class="medal-badge group" title="${i}: ${Math.round(d.val).toLocaleString()}">
                  <span class="text-[10px] md:text-[12px] filter drop-shadow-md select-none leading-none">${d.icon}</span>
                  <span class="text-[10px] font-bold ${d.color} opacity-90 leading-none whitespace-nowrap">${i}</span>
                </div>`}).join("")}</div>`:"";let r="";if(a.favUnits){const d=a.favUnits.d.id>0?A(a.favUnits.d.id):"",i=a.favUnits.k.id>0?A(a.favUnits.k.id):"",c=a.favUnits.t.id>0?A(a.favUnits.t.id):"",m=(_,w,p,k)=>_?`<div class="match-unit-tag ${k} ${p}">
            <span class="truncate opacity-90 flex-1">${_}</span>
            <span class="ml-1 opacity-70">${w}</span>
          </div>`:"",f=m(d,Math.round(a.favUnits.d.v).toLocaleString(),"border-orange-500/30 bg-orange-900/20","text-orange-200"),g=m(i,a.favUnits.k.v,"border-red-500/30 bg-red-900/20","text-red-200"),h=m(c,Math.round(a.favUnits.t.v).toLocaleString(),"border-blue-500/30 bg-blue-900/20","text-blue-200");(f||g||h)&&(r=`<div class="flex flex-col gap-0.5 ml-2 w-24 md:w-32 flex-shrink-0 border-l border-white/10 pl-1 justify-center h-full">
            ${f}${g}${h}
          </div>`)}return`
      <div class="teammate-row flex items-center p-2 md:p-3 rounded-xl md:rounded-2xl ${a.isMe?"is-me":""}" title="${o}" onclick="window.__openPlayerDetail('${t}', '${a.id}')">
        <div class="flex-1 min-w-0 pr-2 md:pr-4 flex flex-col justify-center relative">
          <div class="flex justify-between items-start w-full">
            <div class="text-xs md:text-sm font-black text-slate-100 truncate mb-0.5 mr-1">${j(a.name)}</div>
            <div class="text-right font-mono flex-shrink-0 flex flex-col items-end leading-none">
              <div class="text-[10px] md:text-[11px] font-black ${parseFloat(a.gain)>=0?"text-green-500":"text-red-500"}">${parseFloat(a.gain)>=0?"+":""}${a.gain}</div>
              <div class="text-[9px] md:text-[10px] font-bold text-slate-500">ELO ${a.elo}</div>
            </div>
          </div>
          ${l}
          <div class="id-link mt-1" onclick="event.stopPropagation(); window.__inspect('${a.id}')">${a.id}</div>
        </div>
        <div class="w-16 md:w-28 space-y-1 flex-shrink-0">
          <div class="flex items-center gap-1"><div class="bar-container"><div class="bar-kill" style="width:${a.kPct}%"></div></div></div>
          <div class="flex items-center gap-1"><div class="bar-container"><div class="bar-loss" style="width:${a.lPct}%"></div></div></div>
          <div class="flex items-center gap-1"><div class="bar-container"><div class="bar-obj" style="width:${a.oPct}%"></div></div></div>
        </div>
        ${r}
      </div>`}).join("")}function Ke(e,t){const n=_e.find(r=>String(r.id)===String(e));if(!n)return;let a=n.ally.find(r=>String(r.id)===String(t));if(a||(a=n.enemy.find(r=>String(r.id)===String(t))),!a)return;const o=a.rawData;document.getElementById("pd_name").innerText=a.name||"Unknown",document.getElementById("pd_id").innerText=`ID: ${a.id}`,document.getElementById("pd_elo").innerText=`ELO ${a.elo} (${parseFloat(a.gain)>=0?"+":""}${a.gain})`,document.getElementById("pd_elo").className=parseFloat(a.gain)>=0?"text-green-400 font-mono":"text-red-400 font-mono",document.getElementById("pd_kill").innerText=Math.round(a.kScore).toLocaleString(),document.getElementById("pd_loss").innerText=Math.round(a.lScore).toLocaleString(),document.getElementById("pd_obj").innerText=Math.round(a.oScore).toLocaleString(),document.getElementById("pd_kd").innerText=a.kd.toFixed(2),document.getElementById("pd_dmg_dealt").innerText=Math.round(o.DamageDealt||0).toLocaleString(),document.getElementById("pd_dmg_taken").innerText=Math.round(o.DamageReceived||0).toLocaleString(),document.getElementById("pd_supply").innerText=Math.round(o.SupplyPointsConsumed||0).toLocaleString(),document.getElementById("pd_supply_ally").innerText=Math.round(o.SupplyPointsConsumedFromAllies||0).toLocaleString(),document.getElementById("pd_supply_give").innerText=Math.round(o.SupplyPointsConsumedByAllies||0).toLocaleString(),document.getElementById("pd_units").innerText=Math.round(o.TotalSpawnedUnitScore||0).toLocaleString();const l=(r,d)=>{const i=d&&d.id>0?A(d.id):"-",c=d&&d.v>-1?Math.round(d.v).toLocaleString():"0";document.getElementById(`${r}_name`).innerText=i,document.getElementById(`${r}_val`).innerText=c};l("pd_top_dmg",a.favUnits.d),l("pd_top_kill",a.favUnits.k),l("pd_top_tank",a.favUnits.t),document.getElementById("playerDetailModal").classList.remove("hidden")}function We(){document.getElementById("playerDetailModal").classList.add("hidden")}async function ze(e){await ue();const t=document.getElementById("unitStickerContainer");if(!t)return;t.innerHTML="";const n=Ie(),a=[{type:"dmg",unit:e.topDmg,icon:"‚ö°",labelPrefix:{zh:"ËæìÂá∫",en:"Dmg",ja:"ÁÅ´Âäõ",ru:"Dmg"}},{type:"kill",unit:e.topKill,icon:"üî´",labelPrefix:{zh:"ÂáªÊùÄ",en:"Kill",ja:"ÊíÉÁ†¥",ru:"Kill"}},{type:"tank",unit:e.topTank,icon:"üõ°Ô∏è",labelPrefix:{zh:"Êäó‰º§",en:"Tank",ja:"ËÄê‰πÖ",ru:"Tank"}}];for(const o of a){if(!o.unit||o.unit.id<=0)continue;const l=A(o.unit.id);if(!l)continue;const r=document.createElement("div");let d="bg-slate-600/20 border-slate-500/50 text-slate-300";o.type==="dmg"&&(d="bg-orange-600/20 border-orange-500/50 text-orange-300"),o.type==="kill"&&(d="bg-red-600/20 border-red-500/50 text-red-300"),o.type==="tank"&&(d="bg-blue-600/20 border-blue-500/50 text-blue-300"),r.className=`tag-sticker tag-sticker-left ${d} flex items-center gap-2 cursor-help`;let i="";o.type==="dmg"&&(i=Math.round(o.unit.damageDealt).toLocaleString()),o.type==="kill"&&(i=o.unit.kills),o.type==="tank"&&(i=Math.round(o.unit.damageReceived).toLocaleString()),r.title=`${o.labelPrefix[n]||o.labelPrefix.en}: ${i}`,r.innerHTML=`<span class="text-lg">${o.icon}</span><span>${l}</span>`,t.appendChild(r),await new Promise(c=>setTimeout(c,100))}}const X=S.LS_HISTORY_KEY;function Q(){return JSON.parse(localStorage.getItem(X)||"[]")}function Ye(e,t){let n=Q();n=n.filter(a=>a.id!==e),n.unshift({id:e,name:t||e}),localStorage.setItem(X,JSON.stringify(n.slice(0,10)))}function Ge(e){let t=Q();localStorage.setItem(X,JSON.stringify(t.filter(n=>n.id!==e)))}window.__openPlayerDetail=Ke;window.__inspect=e=>{const t=window.location.origin+window.location.pathname+"?steamId="+e;window.open(t,"_blank")};window.setLang=e=>{de(e),Z()};window.handleCheck=F;window.openSearchModal=qe;window.closeSearchModal=pe;window.openMatchSearchModal=Je;window.closeMatchSearchModal=fe;window.doNameSearch=Ve;window.doMatchSearch=et;window.useFoundId=Ze;window.useFromMatch=tt;window.closePlayerDetailModal=We;window.onload=()=>{de("zh"),Z();const t=new URLSearchParams(window.location.search).get("steamId");t&&(document.getElementById("steamInput").value=t,F())};function Z(){const e=document.getElementById("historyContainer"),t=Q();e.innerHTML=t.map(n=>`
    <div class="flex items-center gap-1 bg-slate-800/50 border border-slate-700 rounded-xl px-3 py-1.5 group hover:border-cyan-500 transition cursor-pointer" onclick="document.getElementById('steamInput').value='${n.id}'; handleCheck();">
      <span class="text-xs text-slate-300 font-bold truncate max-w-[100px]">${j(n.name)}</span>
      <button onclick="event.stopPropagation(); window.__removeHistory('${n.id}')" class="text-slate-500 hover:text-red-400 text-xs font-bold ml-1 opacity-0 group-hover:opacity-100 transition">√ó</button>
    </div>`).join("")}window.__removeHistory=e=>{Ge(e),Z()};async function F(){const e=document.getElementById("steamInput").value.trim();if(!e)return;const t=R();document.getElementById("errorArea").classList.add("hidden"),document.getElementById("loading").classList.remove("hidden"),document.getElementById("resultPanel").classList.add("hidden"),document.getElementById("unitStickerContainer").innerHTML="",O(0,t.loading,"Initializing..."),ue();try{let n=e;(e.length>10||isNaN(e))&&(O(5,"Resolving...","Checking Identity..."),n=(await De(e)).uid),O(10,"Scanning...","Pulling Matches...");const a=await Ee(n),o=3,l=[];let r=0;for(;r<a.length&&l.length<S.MATCH_GOAL;){const m=a.slice(r,r+o);r+=o;const f=await Promise.allSettled(m.map(async g=>{const h=await Le(g);return{id:g,data:h}}));for(const g of f){if(l.length>=S.MATCH_GOAL)break;if(g.status!=="fulfilled"){console.error("Match fetch failed",g.reason);continue}const{id:h,data:_}=g.value,w=Object.values(_.Data),p=w.some(k=>Math.abs(k.NewRating-k.OldRating)>.01);if(w.length>=S.MIN_PLAYERS&&p){l.push({id:h,data:_});const k=Math.round(l.length/S.MATCH_GOAL*100);O(k,`Syncing (${l.length}/12)`,`Match ${h} OK`)}}l.length<S.MATCH_GOAL&&r<a.length&&await new Promise(g=>setTimeout(g,200))}if(l.length<S.MATCH_GOAL)throw new Error(t.err_insufficient);const d=l[0].data.Data[n];Ye(n,d==null?void 0:d.Name),document.getElementById("userNameDisplay").innerText=`${(d==null?void 0:d.Name)||"Unknown"} ${d!=null&&d.Level?"(Lv."+d.Level+")":""}`,document.getElementById("calcTimeDisplay").innerText=`Calculated: ${new Date().toLocaleString()}`;const i=Ce(n,l);Oe(i);const c=Ae(l,n);c&&ze(c)}catch(n){document.getElementById("errorArea").classList.remove("hidden"),document.getElementById("errorMsg").innerText=n.message}finally{document.getElementById("loading").classList.add("hidden")}}function qe(){document.getElementById("idSearchModal").classList.remove("hidden"),document.getElementById("modalSearchInput").focus()}function pe(){document.getElementById("idSearchModal").classList.add("hidden")}function Je(){document.getElementById("matchSearchModal").classList.remove("hidden"),document.getElementById("matchIdInput").focus()}function fe(){document.getElementById("matchSearchModal").classList.add("hidden"),document.getElementById("matchModalResultArea").classList.add("hidden"),document.getElementById("matchIdInput").value="",document.getElementById("matchModalStatus").innerText=""}async function Ve(){const e=document.getElementById("modalSearchInput").value.trim(),t=document.getElementById("modalStatusMsg"),n=document.getElementById("modalResultList"),a=document.getElementById("modalFinalResult"),o=R();if(e){t.innerText=o.modal_status_search,t.className="text-xs text-orange-400 min-h-[1.5rem] mb-2 pl-1 animate-pulse",n.classList.add("hidden"),a.classList.add("hidden"),n.innerHTML="";try{const l=await Me(e);if(l.length===0){t.innerText=o.modal_status_none,t.className="text-xs text-red-400 min-h-[1.5rem] mb-2 pl-1";return}t.innerText=o.modal_status_found.replace("{n}",l.length),t.className="text-xs text-green-400 min-h-[1.5rem] mb-2 pl-1",Xe(l)}catch(l){t.innerText=o.modal_status_err+l.message,t.className="text-xs text-red-400 min-h-[1.5rem] mb-2 pl-1"}}}function Xe(e){const t=document.getElementById("modalResultList");t.classList.remove("hidden"),t.innerHTML=e.map(n=>`
    <div class="search-result-item flex items-center justify-between p-3 bg-slate-800/50 border border-slate-700 rounded-xl cursor-pointer transition hover:bg-orange-900/20 hover:border-orange-500/50" data-player='${JSON.stringify(n).replace(/'/g,"&#39;")}'>
      <div class="flex-1 min-w-0">
        <div class="text-sm font-bold text-slate-100 truncate">${j(n.name||n.Name||"Unknown")}</div>
        <div class="text-[10px] font-mono text-slate-500">ID: ${n.stbId||n.id||"N/A"}</div>
      </div>
      <div class="text-right ml-4">
        <div class="text-[10px] text-slate-400 font-mono">ELO ${n.elo?n.elo.toFixed(0):"N/A"}</div>
      </div>
    </div>`).join(""),t.querySelectorAll(".search-result-item").forEach(n=>{n.onclick=()=>{const a=JSON.parse(n.dataset.player);Qe(a)}})}function Qe(e){const t=document.getElementById("modalFinalResult");document.getElementById("modalSelectedName").innerText=e.name||e.Name||"Unknown",document.getElementById("modalSelectedId").innerText=e.stbId||e.id||"N/A",t.classList.remove("hidden")}function Ze(){const e=document.getElementById("modalSelectedId").innerText;document.getElementById("steamInput").value=e,pe(),F()}async function et(){const e=document.getElementById("matchIdInput").value.trim(),t=document.getElementById("matchModalStatus"),n=document.getElementById("matchModalResultArea"),a=R();if(e){t.innerText=a.modal_match_loading,t.className="text-xs mb-4 pl-1 text-cyan-400 animate-pulse",n.classList.add("hidden");try{const o=await P(`${S.BARMORY_BASE}/stb/match/${e}`),l=o.Data;if(o.WinnerTeam===void 0){const f=Object.values(l).find(g=>g.NewRating!==void 0&&g.OldRating!==void 0);if(f){const g=f.NewRating-f.OldRating>=0;o.WinnerTeam=g?f.TeamId:f.TeamId===1?0:1}}const r=Object.entries(l).map(([m,f])=>({...f,Id:m})),d=r.filter(m=>m.TeamId===0||m.TeamId===void 0),i=r.filter(m=>m.TeamId===1),c=m=>{var g;const f=m.TeamId===o.WinnerTeam;return`
      <div onclick="useFromMatch('${m.Id}')" class="flex items-center justify-between p-3 bg-slate-800/50 hover:bg-cyan-900/30 border border-slate-700 hover:border-cyan-500 rounded-xl cursor-pointer transition group">
        <div class="flex-1 min-w-0">
          <div class="text-sm font-bold text-slate-100 group-hover:text-white truncate">${j(m.Name||"Unknown")}</div>
          <div class="text-[10px] font-mono text-slate-500 group-hover:text-cyan-400/70">ID: ${m.Id}</div>
        </div>
        <div class="text-right ml-4">
          <div class="text-[10px] font-black ${f?"text-cyan-400":"text-red-400"}">${f?a.res_vic:a.res_def}</div>
          <div class="text-[10px] text-slate-400 font-mono">ELO ${((g=m.NewRating)==null?void 0:g.toFixed(0))||"---"}</div>
        </div>
      </div>`};document.getElementById("matchModalTeam0").innerHTML='<div class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 px-1">Team Alpha</div>'+d.map(c).join(""),document.getElementById("matchModalTeam1").innerHTML='<div class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2 px-1">Team Bravo</div>'+i.map(c).join(""),t.innerText="",n.classList.remove("hidden")}catch{t.innerText=a.modal_match_err,t.className="text-xs mb-4 pl-1 text-red-400"}}}function tt(e){document.getElementById("steamInput").value=e,fe(),F()}
